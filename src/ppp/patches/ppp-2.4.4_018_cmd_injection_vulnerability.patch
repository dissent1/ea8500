diff -Nur ppp-2.4.4-old/pppd/plugins/rp-pppoe/discovery.c ppp-2.4.4-new/pppd/plugins/rp-pppoe/discovery.c
--- ppp-2.4.4-old/pppd/plugins/rp-pppoe/discovery.c	2016-11-23 10:41:24.464611750 +0800
+++ ppp-2.4.4-new/pppd/plugins/rp-pppoe/discovery.c	2016-11-29 09:26:55.438231044 +0800
@@ -1,4 +1,4 @@
-/* Modifications were made by Cisco Systems, Inc. on or before Wed Nov 30 13:28:05 PST 2011 */
+/* Modifications were made by Belkin International, Inc. on or before Wed Nov 23 14:13:39 PDT 2016 */
 /***********************************************************************
 *
 * discovery.c
@@ -114,7 +114,7 @@
     struct PacketCriteria *pc = (struct PacketCriteria *) extra;
     PPPoEConnection *conn = pc->conn;
     int i;
-	char cmd[256];
+	char cmd[64];
 	memset(cmd,0,sizeof(cmd));
     switch(type) {
     case TAG_AC_NAME:
@@ -123,8 +123,12 @@
 	    printf("Access-Concentrator: %.*s\n", (int) len, data);
 	}
 	/*add by taliang@cisco.com @13/02 2012 for tr69*/
-	sprintf(cmd, "sysevent set wan_pppoe_acname %.*s",(int)len, data);
-	system(cmd);
+
+    if ((strchr(data, ';') == NULL) && (strchr(data, '&') == NULL) && (strchr(data, '|') == NULL) && (strchr(data, '>') == NULL) && (strchr(data, '<') == NULL) && (strchr(data, '`') == NULL) && (strchr(data, '$') == NULL) )
+    {
+	    snprintf(cmd, sizeof(cmd)-1, "sysevent set wan_pppoe_acname %.*s",(int)len, data);
+	    system(cmd);
+    }
 	if (conn->acName && len == strlen(conn->acName) &&
 	    !strncmp((char *) data, conn->acName, len)) {
 	    pc->acNameOK = 1;
